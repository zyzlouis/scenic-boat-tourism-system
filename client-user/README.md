# 景区游船计时收费系统 - 用户端小程序

## 项目介绍

用户端微信小程序，用于游客浏览船型、下单支付、查看订单和实时计时等功能。

## 技术栈

- **框架**: 微信原生小程序
- **UI组件**: Vant Weapp
- **语言**: JavaScript

## 项目结构

```
client-user/
├── pages/                  # 页面目录
│   ├── index/             # 首页（船型选择）
│   ├── order-detail/      # 订单详情页
│   ├── order-list/        # 订单列表页
│   └── payment/           # 支付页
├── components/            # 自定义组件
├── utils/                 # 工具函数
│   ├── api.js            # API请求封装
│   └── util.js           # 工具函数
├── config/                # 配置文件
├── images/                # 图片资源
├── app.js                 # 小程序入口
├── app.json               # 小程序配置
├── app.wxss               # 全局样式
├── package.json
└── README.md
```

## 功能清单

### 已实现
- ✅ 船型列表展示
- ✅ 创建订单
- ✅ 订单详情查看
- ✅ 订单列表查看
- ✅ 实时计时看板
- ✅ 核销码展示

### 待实现（TODO）
- ⏳ 微信登录
- ⏳ 微信支付
- ⏳ WebSocket实时推送
- ⏳ 服务通知
- ⏳ 分享功能

## 快速开始

### 1. 安装依赖

```bash
npm install
```

### 2. 构建npm包

在微信开发者工具中：
- 点击 **工具 -> 构建npm**
- 等待构建完成

### 3. 配置API地址

修改 `app.js` 中的 `baseUrl`：

```javascript
globalData: {
  baseUrl: 'https://your-api-domain.com/api/v1'  // 修改为实际的API地址
}
```

### 4. 配置微信小程序AppID

在微信开发者工具中，点击 **详情 -> 基本信息**，填入你的AppID。

### 5. 运行

在微信开发者工具中点击 **编译** 即可预览。

## 页面说明

### 首页（index）
- 展示所有可租赁的船型
- 显示价格、包含时长、超时费率等信息
- 点击"立即租赁"创建订单并跳转支付

### 订单详情页（order-detail）
- 显示订单状态
- 显示核销码（已支付订单）
- 显示计时看板（计时中订单，每5秒自动刷新）
- 显示结算信息（已完成订单）

### 订单列表页（order-list）
- 展示用户的所有订单
- 支持下拉刷新
- 支持上拉加载更多
- 点击订单卡片查看详情

## API对接

所有API请求通过 `utils/api.js` 统一管理，包含：
- 自动添加Token认证
- 统一错误处理
- Token失效自动跳转登录

## 样式规范

- 使用 Vant Weapp 组件库
- 主色调：`#1989fa`（蓝色）
- 价格颜色：`#ff4444`（红色）
- 全局样式定义在 `app.wxss`

## 调试建议

### 1. 本地开发
- 在微信开发者工具中勾选 **不校验合法域名**
- 后端API地址使用本地地址（如 `http://localhost:3000/api/v1`）

### 2. 真机调试
- 需要在微信公众平台配置服务器域名
- 后端API必须使用HTTPS

## 常见问题

### 1. API请求失败
- 检查 `app.js` 中的 `baseUrl` 是否正确
- 检查后端服务是否已启动
- 检查网络连接

### 2. Vant组件不显示
- 确认已执行 **构建npm**
- 检查 `app.json` 中的 `usingComponents` 配置

### 3. Token失效
- 点击重新登录即可
- Token默认有效期为7天

## 许可证

ISC
