<!--pages/recharge-logs/recharge-logs.wxml-->
<wxs src="../../utils/format.wxs" module="format" />

<view class="logs-container">
  <!-- 加载中 -->
  <view wx:if="{{loading && logs.length === 0}}" class="loading-container">
    <van-loading size="48rpx" type="spinner" color="#1989fa">加载中...</van-loading>
  </view>

  <!-- 记录列表 -->
  <view wx:elif="{{logs.length > 0}}" class="logs-list">
    <view wx:for="{{logs}}" wx:key="_id" class="log-item">
      <view class="log-header">
        <view class="log-type-container">
          <van-tag
            type="{{item.type === 'recharge' ? 'success' : (item.type === 'consume' ? 'danger' : 'primary')}}"
            size="medium"
          >
            {{item.type === 'recharge' ? '充值' : (item.type === 'consume' ? '消费' : '退款')}}
          </van-tag>
          <text class="log-desc">{{item.description}}</text>
        </view>
        <view class="log-amount {{item.changeAmount > 0 ? 'positive' : 'negative'}}">
          {{item.changeAmount > 0 ? '+' : ''}}{{format.formatMoney(item.changeAmount)}}
        </view>
      </view>
      <view class="log-footer">
        <text class="log-time">{{item.createdAt}}</text>
        <text class="log-balance">余额：¥{{format.formatMoney(item.afterBalance)}}</text>
      </view>
    </view>

    <!-- 加载更多 -->
    <view wx:if="{{hasMore}}" class="load-more">
      <van-loading wx:if="{{loading}}" size="20rpx" type="spinner" color="#1989fa">加载中...</van-loading>
      <text wx:else class="load-more-text">上拉加载更多</text>
    </view>
    <view wx:else class="no-more">
      <text>没有更多记录了</text>
    </view>
  </view>

  <!-- 空状态 -->
  <view wx:else class="empty-container">
    <van-empty description="暂无记录" />
  </view>
</view>
