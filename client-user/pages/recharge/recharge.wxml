<!--pages/recharge/recharge.wxml-->
<view class="recharge-container">
  <view class="header">
    <text class="title">选择充值金额</text>
  </view>

  <!-- 加载中 -->
  <view wx:if="{{loading}}" class="loading-container">
    <van-loading size="48rpx" type="spinner" color="#1989fa">加载中...</van-loading>
  </view>

  <!-- 充值方案列表 -->
  <view wx:else class="plans-grid">
    <view
      wx:for="{{plans}}"
      wx:key="_id"
      class="plan-card {{selectedPlanId === item._id ? 'selected' : ''}}"
      data-id="{{item._id}}"
      bindtap="selectPlan"
    >
      <view wx:if="{{item.tag}}" class="plan-tag">
        <van-tag type="danger" size="medium">{{item.tag}}</van-tag>
      </view>
      <view class="plan-amount">¥{{item.amount}}</view>
      <view class="plan-gift">送{{item.giftAmount}}元</view>
      <view class="plan-total">到账¥{{item.totalAmount}}</view>
    </view>
  </view>

  <!-- 充值详情 -->
  <view wx:if="{{selectedPlan}}" class="summary">
    <view class="summary-row">
      <text class="summary-label">充值金额：</text>
      <text class="summary-value">¥{{selectedPlan.amount}}</text>
    </view>
    <view class="summary-row">
      <text class="summary-label">赠送金额：</text>
      <text class="summary-value highlight">+¥{{selectedPlan.giftAmount}}</text>
    </view>
    <view class="summary-divider"></view>
    <view class="summary-row total">
      <text class="summary-label">到账总额：</text>
      <text class="summary-value total">¥{{selectedPlan.totalAmount}}</text>
    </view>
  </view>

  <!-- 充值按钮 -->
  <view class="footer">
    <van-button type="primary" size="large" round bind:click="doRecharge" block>
      立即充值
    </van-button>
    <view class="agreement">
      充值即表示同意
      <text class="link" bindtap="showAgreement">《储值服务协议》</text>
    </view>
  </view>
</view>
