<!--pages/orders/orders.wxml-->
<wxs module="filters" src="../../utils/filters.wxs"></wxs>
<view class="container">
  <!-- é¡¶éƒ¨ç»Ÿè®¡ -->
  <view class="stats-card card">
    <view class="stat-item">
      <view class="stat-value">{{orders.length}}</view>
      <view class="stat-label">è®¡æ—¶ä¸­</view>
    </view>
    <view class="stat-divider"></view>
    <view class="stat-item">
      <view class="stat-value status-warning">
        {{overtimeCount}}
      </view>
      <view class="stat-label">å·²è¶…æ—¶</view>
    </view>
  </view>

  <!-- åŠ è½½ä¸­ -->
  <view wx:if="{{loading}}" class="loading-container">
    <van-loading size="48rpx" type="spinner" color="#07c160">åŠ è½½ä¸­...</van-loading>
  </view>

  <!-- è®¢å•åˆ—è¡¨ -->
  <view wx:elif="{{orders.length > 0}}" class="order-list">
    <view
      wx:for="{{orders}}"
      wx:key="orderId"
      class="order-item card"
      data-order="{{item}}"
      bindtap="handleOrder"
    >
      <!-- è®¢å•å¤´éƒ¨ -->
      <view class="order-header">
        <view class="boat-number">
          <text class="icon">ğŸš¤</text>
          <text class="number">{{item.boatNumber}}</text>
        </view>
        <view class="boat-type">{{item.boatTypeName}}</view>
      </view>

      <!-- è®¢å•ä¿¡æ¯ -->
      <view class="order-body">
        <view class="info-row">
          <text class="label">æ¸¸å®¢ï¼š</text>
          <text class="value">{{item.userNickname}}</text>
        </view>
        <view class="info-row">
          <text class="label">å¼€å§‹ï¼š</text>
          <text class="value">{{filters.formatTime(item.startTime)}}</text>
        </view>
        <view class="info-row highlight">
          <text class="label">æ—¶é•¿ï¼š</text>
          <text class="value">{{filters.formatDuration(item.usedMinutes)}}</text>
        </view>
      </view>

      <!-- è¶…æ—¶æé†’ -->
      <view wx:if="{{item.isOvertime}}" class="overtime-alert">
        <text class="icon">âš ï¸</text>
        <text class="text">å·²è¶…æ—¶ {{filters.formatDuration(item.overtimeMinutes)}}</text>
      </view>

      <!-- æ“ä½œæŒ‰é’® -->
      <view class="order-action">
        <view class="action-text">ç‚¹å‡»æ”¶èˆ¹ â†’</view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view wx:else class="empty-container">
    <van-empty description="æš‚æ— å¾…å¤„ç†è®¢å•" />
    <view class="empty-tip">æ‰€æœ‰æ¸¸èˆ¹éƒ½å·²å½’è¿˜ï¼Œè¾›è‹¦äº†ï¼âœ¨</view>
  </view>
</view>
