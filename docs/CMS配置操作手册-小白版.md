# 微信云开发CMS配置操作手册（小白版）

**文档用途**：指导运营人员配置云开发内容管理系统（CMS）
**目标用户**：无技术背景的运营人员
**预计时间**：30-45分钟
**更新日期**：2026-02-12

---

## 📋 前置条件检查

在开始配置之前，请确认：

- ✅ 已在云数据库中初始化了7个集合（通过 initDatabase 云函数）
- ✅ 7个集合分别是：boatTypes、pricingConfigs、boats、staff、banners、announcements、app_settings
- ✅ 每个集合都有测试数据

**如何检查**：
1. 打开微信开发者工具
2. 点击【云开发】按钮
3. 左侧菜单选择【数据库】
4. 确认看到7个集合，每个集合都有数据

---

## 第一步：开通内容管理（CMS）

### 1.1 进入内容管理

1. 在微信开发者工具中，点击顶部的【云开发】按钮
2. 在左侧菜单中找到【内容管理】
3. 点击【内容管理】

### 1.2 开通CMS

**如果是第一次使用**：
1. 页面会提示"开通内容管理服务"
2. 点击【立即开通】按钮
3. 阅读服务协议，勾选"我已阅读并同意"
4. 点击【确定】
5. 等待开通完成（约10秒）

**如果已经开通**：
- 直接进入内容管理界面

### 1.3 确认开通成功

开通成功后，您会看到：
- 顶部有"内容管理"标题
- 左侧有"内容模型"菜单
- 中间显示"暂无内容模型"或已有的模型列表

---

## 第二步：创建内容模型

我们需要为7个集合分别创建内容模型。**顺序任意，逐个创建即可。**

---

### 模型1：boatTypes（船型配置）

#### 2.1.1 创建模型

1. 在内容管理界面，点击左上角的【新建内容模型】按钮
2. 填写基本信息：
   - **模型名称**：`船型配置`（显示名称，运营人员看到的）
   - **集合名称**：`boatTypes`（必须完全一致，区分大小写）
   - **模型描述**：`管理游船的船型信息，包括双人船、四人船、六人船等`
3. 点击【创建】

#### 2.1.2 配置字段

模型创建后，会自动进入字段配置页面。点击【添加字段】，依次添加以下字段：

| 序号 | 字段名称 | 字段标识 | 字段类型 | 是否必填 | 备注 |
|------|---------|---------|---------|---------|------|
| 1 | 船型代码 | code | 单行字符串 | 是 | ⚠️ **设为只读** |
| 2 | 船型名称 | name | 单行字符串 | 是 | |
| 3 | 船型描述 | description | 多行字符串 | 否 | |
| 4 | 最大载客数 | maxCapacity | 数字 | 是 | |
| 5 | 船型图片 | imageUrl | 图片 | 否 | |
| 6 | 排序 | sort | 数字 | 是 | 数字越小越靠前 |
| 7 | 是否启用 | enabled | 布尔值 | 是 | 默认值：true |

**⚠️ 重要：code 字段设为只读**

在添加 `code` 字段时：
1. 字段类型选择"单行字符串"
2. 在"字段设置"中，找到"是否只读"选项
3. **勾选"只读"**
4. 如果没有"只读"选项，在字段描述中写：**"⚠️ 此字段为系统标识，严禁修改，否则会导致价格配置和船只关联失效！"**

#### 2.1.3 保存模型

1. 检查所有字段是否添加完整
2. 点击【保存】按钮
3. 返回内容管理首页

---

### 模型2：pricingConfigs（价格配置）

#### 2.2.1 创建模型

1. 点击【新建内容模型】
2. 填写基本信息：
   - **模型名称**：`价格配置`
   - **集合名称**：`pricingConfigs`
   - **模型描述**：`管理不同船型的价格方案，包括基础价格、押金、超时费率等`
3. 点击【创建】

#### 2.2.2 配置字段

| 序号 | 字段名称 | 字段标识 | 字段类型 | 是否必填 | 备注 |
|------|---------|---------|---------|---------|------|
| 1 | 船型代码 | boatTypeCode | 单行字符串 | 是 | 关联船型（填DOUBLE/FOUR/SIX） |
| 2 | 价格方案名称 | name | 单行字符串 | 是 | 如"双人船-平日价" |
| 3 | 基础价格（元） | basePrice | 数字 | 是 | |
| 4 | 押金金额（元） | depositAmount | 数字 | 是 | |
| 5 | 包含时长（分钟） | includedMinutes | 数字 | 是 | |
| 6 | 超时费率（元/分钟） | overtimeRate | 数字 | 是 | |
| 7 | 封顶金额（元） | capAmount | 数字 | 否 | 超时费用上限 |
| 8 | 生效日期 | effectiveDate | 日期时间 | 否 | 留空表示立即生效 |
| 9 | 失效日期 | expiryDate | 日期时间 | 否 | 留空表示永久有效 |
| 10 | 是否默认 | isDefault | 布尔值 | 是 | |
| 11 | 排序 | sort | 数字 | 是 | |
| 12 | 是否启用 | enabled | 布尔值 | 是 | 默认值：true |

#### 2.2.3 保存模型

点击【保存】

---

### 模型3：boats（船只管理）

#### 2.3.1 创建模型

1. 点击【新建内容模型】
2. 填写基本信息：
   - **模型名称**：`船只管理`
   - **集合名称**：`boats`
   - **模型描述**：`管理景区所有游船，包括船号、所属船型、状态等`
3. 点击【创建】

#### 2.3.2 配置字段

| 序号 | 字段名称 | 字段标识 | 字段类型 | 是否必填 | 备注 |
|------|---------|---------|---------|---------|------|
| 1 | 船号 | boatNumber | 单行字符串 | 是 | 如A001、B001 |
| 2 | 船型代码 | boatTypeCode | 单行字符串 | 是 | 关联船型（填DOUBLE/FOUR/SIX） |
| 3 | 状态 | status | 枚举 | 是 | 可选值：idle/in_use/maintenance |
| 4 | 最后使用时间 | lastUsedAt | 日期时间 | 否 | |
| 5 | 排序 | sort | 数字 | 是 | |
| 6 | 是否启用 | enabled | 布尔值 | 是 | 默认值：true |

**枚举字段配置（status）**：
- 在添加 `status` 字段时，选择"枚举"类型
- 添加可选值：
  - `idle`（显示名：空闲）
  - `in_use`（显示名：使用中）
  - `maintenance`（显示名：维护中）

#### 2.3.3 保存模型

点击【保存】

---

### 模型4：staff（员工管理）

#### 2.4.1 创建模型

1. 点击【新建内容模型】
2. 填写基本信息：
   - **模型名称**：`员工管理`
   - **集合名称**：`staff`
   - **模型描述**：`管理景区工作人员账号，包括管理员和普通员工`
3. 点击【创建】

#### 2.4.2 配置字段

| 序号 | 字段名称 | 字段标识 | 字段类型 | 是否必填 | 备注 |
|------|---------|---------|---------|---------|------|
| 1 | 用户名 | username | 单行字符串 | 是 | |
| 2 | 密码 | password | 单行字符串 | 是 | ⚠️ **设为隐藏** |
| 3 | 真实姓名 | realName | 单行字符串 | 是 | |
| 4 | 手机号 | phone | 单行字符串 | 是 | |
| 5 | 角色 | role | 枚举 | 是 | 可选值：admin/staff |
| 6 | 最后登录时间 | lastLoginAt | 日期时间 | 否 | |
| 7 | 排序 | sort | 数字 | 是 | |
| 8 | 是否启用 | enabled | 布尔值 | 是 | 默认值：true |

**⚠️ 重要：password 字段设为隐藏**

在添加 `password` 字段时：
1. 字段类型选择"单行字符串"
2. 在"字段设置"中，找到"是否隐藏"选项
3. **勾选"隐藏"**
4. 如果没有"隐藏"选项，在字段描述中写：**"⚠️ 此字段为加密密码，严禁查看和编辑！新增员工和修改密码请通过云函数操作。"**

**枚举字段配置（role）**：
- `admin`（显示名：管理员）
- `staff`（显示名：普通员工）

#### 2.4.3 保存模型

点击【保存】

---

### 模型5：banners（轮播图）

#### 2.5.1 创建模型

1. 点击【新建内容模型】
2. 填写基本信息：
   - **模型名称**：`轮播图管理`
   - **集合名称**：`banners`
   - **模型描述**：`管理小程序首页的轮播图和广告位`
3. 点击【创建】

#### 2.5.2 配置字段

| 序号 | 字段名称 | 字段标识 | 字段类型 | 是否必填 | 备注 |
|------|---------|---------|---------|---------|------|
| 1 | 标题 | title | 单行字符串 | 是 | |
| 2 | 图片 | imageUrl | 图片 | 是 | |
| 3 | 链接类型 | linkType | 枚举 | 是 | 可选值：none/page/web |
| 4 | 链接地址 | linkUrl | 单行字符串 | 否 | linkType为none时留空 |
| 5 | 排序 | sort | 数字 | 是 | |
| 6 | 是否启用 | enabled | 布尔值 | 是 | 默认值：true |

**枚举字段配置（linkType）**：
- `none`（显示名：无跳转）
- `page`（显示名：小程序页面）
- `web`（显示名：外部网页）

#### 2.5.3 保存模型

点击【保存】

---

### 模型6：announcements（公告通知）

#### 2.6.1 创建模型

1. 点击【新建内容模型】
2. 填写基本信息：
   - **模型名称**：`公告通知`
   - **集合名称**：`announcements`
   - **模型描述**：`管理景区公告，可在首页弹窗显示`
3. 点击【创建】

#### 2.6.2 配置字段

| 序号 | 字段名称 | 字段标识 | 字段类型 | 是否必填 | 备注 |
|------|---------|---------|---------|---------|------|
| 1 | 标题 | title | 单行字符串 | 是 | |
| 2 | 内容 | content | 多行字符串/富文本 | 是 | |
| 3 | 公告类型 | type | 枚举 | 是 | 可选值：info/warning/urgent |
| 4 | 首页弹窗显示 | showOnHome | 布尔值 | 是 | |
| 5 | 开始日期 | startDate | 日期时间 | 是 | |
| 6 | 结束日期 | endDate | 日期时间 | 是 | |
| 7 | 排序 | sort | 数字 | 是 | |
| 8 | 是否启用 | enabled | 布尔值 | 是 | 默认值：true |

**枚举字段配置（type）**：
- `info`（显示名：通知）
- `warning`（显示名：警告）
- `urgent`（显示名：紧急）

#### 2.6.3 保存模型

点击【保存】

---

### 模型7：app_settings（基础设置）

#### 2.7.1 创建模型

1. 点击【新建内容模型】
2. 填写基本信息：
   - **模型名称**：`基础设置`
   - **集合名称**：`app_settings`
   - **模型描述**：`景区基础信息配置，只有1条记录`
3. 点击【创建】

#### 2.7.2 配置字段

| 序号 | 字段名称 | 字段标识 | 字段类型 | 是否必填 | 备注 |
|------|---------|---------|---------|---------|------|
| 1 | 景区名称 | scenicName | 单行字符串 | 是 | |
| 2 | 联系电话 | contactPhone | 单行字符串 | 是 | |
| 3 | 营业开始时间 | openTime | 单行字符串 | 是 | 格式：08:00 |
| 4 | 营业结束时间 | closeTime | 单行字符串 | 是 | 格式：18:00 |
| 5 | 退款规则 | refundRules | 多行字符串 | 是 | |
| 6 | 安全须知 | safetyNotice | 多行字符串 | 是 | |
| 7 | 关于我们 | aboutUs | 多行字符串/富文本 | 是 | |
| 8 | Logo图片 | logoUrl | 图片 | 否 | |
| 9 | 排序 | sort | 数字 | 是 | 固定为1 |
| 10 | 是否启用 | enabled | 布尔值 | 是 | 默认值：true |

#### 2.7.3 保存模型

点击【保存】

---

## 第三步：配置用户权限

### 3.1 添加管理员

1. 在内容管理界面，点击右上角的【设置】按钮
2. 选择【用户管理】
3. 点击【添加用户】
4. 填写管理员信息：
   - 微信号或邮箱
   - 角色：管理员
5. 点击【确定】

### 3.2 配置角色权限

1. 在【设置】→【角色管理】中
2. 配置不同角色的权限：
   - **管理员**：所有集合的读写权限
   - **运营人员**：banners、announcements、app_settings 的读写权限
   - **运营人员**：boatTypes、pricingConfigs、boats 的读写权限
   - **运营人员**：staff 的只读权限（新增员工通过云函数）
   - **运营人员**：orders 的只读权限

---

## 第四步：验证配置

### 4.1 检查内容模型

1. 在内容管理首页，确认看到7个内容模型：
   - 船型配置（boatTypes）
   - 价格配置（pricingConfigs）
   - 船只管理（boats）
   - 员工管理（staff）
   - 轮播图管理（banners）
   - 公告通知（announcements）
   - 基础设置（app_settings）

### 4.2 测试编辑内容

1. 点击任意一个内容模型（如"轮播图管理"）
2. 应该能看到已导入的测试数据
3. 点击【编辑】按钮，尝试修改某个字段
4. 点击【保存】
5. 确认修改成功

### 4.3 检查特殊字段

**检查 boatTypes.code 是否只读**：
1. 进入"船型配置"
2. 编辑任意一条记录
3. 尝试修改"船型代码"字段
4. 应该无法修改或有明显警告提示

**检查 staff.password 是否隐藏**：
1. 进入"员工管理"
2. 编辑任意一条记录
3. "密码"字段应该不可见或无法查看

---

## 第五步：日常使用说明

### 5.1 修改船型价格

1. 进入"价格配置"
2. 找到要修改的价格方案
3. 点击【编辑】
4. 修改价格字段
5. 点击【保存】

### 5.2 添加轮播图

1. 进入"轮播图管理"
2. 点击【新建】
3. 填写标题、上传图片、选择链接类型
4. 设置排序值（数字越小越靠前）
5. 勾选"是否启用"
6. 点击【保存】

### 5.3 发布公告

1. 进入"公告通知"
2. 点击【新建】
3. 填写标题、内容、选择公告类型
4. 设置开始/结束日期
5. 如果需要首页弹窗，勾选"首页弹窗显示"
6. 勾选"是否启用"
7. 点击【保存】

### 5.4 新增员工账号

⚠️ **注意：不能在CMS中直接新增员工！**

新增员工必须通过云函数：
1. 联系技术人员
2. 提供员工信息：用户名、密码、真实姓名、手机号、角色
3. 技术人员通过 `manageStaff` 云函数创建账号

---

## 常见问题

### Q1：为什么船型代码（code）不能修改？

**A**：船型代码是系统标识，用于关联价格配置和船只信息。如果修改了，所有关联关系都会失效，导致系统无法正常使用。

### Q2：为什么看不到员工的密码？

**A**：密码已经过加密存储，出于安全考虑，任何人都无法查看原始密码。如需重置密码，请联系技术人员通过云函数操作。

### Q3：如何调整轮播图的显示顺序？

**A**：编辑轮播图记录，修改"排序"字段的数值。数字越小越靠前。例如：1排在最前面，2排在第二位，以此类推。

### Q4：公告的日期范围如何生效？

**A**：系统会自动判断当前时间是否在开始日期和结束日期之间，只有在有效期内且"是否启用"为true的公告才会显示。

### Q5：修改基础设置后需要重启小程序吗？

**A**：不需要。用户端小程序会自动读取最新的设置数据。

---

## 重要提醒

1. **修改船型代码（code）**：严禁修改，会导致系统关联失效
2. **员工密码管理**：不能在CMS中操作，必须通过云函数
3. **删除数据**：删除前务必确认，已删除的数据无法恢复
4. **图片上传**：建议图片大小不超过2MB，格式为jpg或png
5. **定期备份**：重要修改前建议先导出数据备份

---

**配置完成标志**：

- ✅ 7个内容模型全部创建
- ✅ 每个模型的字段全部配置正确
- ✅ 特殊字段（code、password）设置正确
- ✅ 能够成功编辑和保存内容
- ✅ 运营人员账号已添加

**下一步**：交接给运营人员，进行日常内容管理工作。

---

**文档版本**：v1.0
**最后更新**：2026-02-12
**技术支持**：如有问题请联系开发人员
